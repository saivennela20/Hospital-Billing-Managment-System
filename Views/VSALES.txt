CREATE OR REPLACE VIEW VSALES AS(
SELECT 
O.ORDER_ID,
TO_CHAR(O.ORDER_DATE , 'DD-MON-YYYY') AS ORDER_DATE,
O.SHIPPING_DAYS AS SHIPPING_DAYS,
O.DELIVERY_MODE AS DELIVERY_MODE,
PC.CATEGORY_ID AS CATEGORY_ID,
PC.CATEGORY_NAME AS CATEGORY_NAME,
PD.PROD_DETAIL_ID AS PROD_DETAIL_ID,
PD.PROD_NAME AS PRODUCT_NAME,
V.VENDOR_NAME AS VENDOR_NAME,
O.ORDER_STATUS AS OVERALL_STATUS,
I.QUANTITY,
I.TOTAL_LINE_AMOUNT,
I.ORDER_STATUS AS LINE_ITEM_STATUS,
C.CUST_ID,
C.CUST_FIRST_NAME ||' ' || C.CUST_LAST_NAME || ' ' || C.CUST_MIDDLE_NAME AS CUSTOMER_NAME,
C.CUST_GENDER AS GENDER
FROM 
CUSTOMER C,
ORDERS O,
LINE_ITEMS I,
PRODUCT_CATEGORY PC,
VENDOR V,
PRODUCT_DETAILS PD
WHERE C.CUST_ID = O.CUST_ID
AND O.ORDER_ID = I.ORDER_ID
AND I.PROD_DETAIL_ID = PD.PROD_DETAIL_ID
AND PD.CATEGORY_ID = PC.CATEGORY_ID
AND PD.VENDOR_ID = V.VENDOR_ID
-----AND C.CUST_ID = 'CUST-130'
);
